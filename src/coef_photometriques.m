% calcule Q0, S1, S2

function coef=coef_photometriques(tab_cie)
tg_gamma=[0:0.25:2 2.5:0.5:12]';
tab_pondere = [  8,   8,  32,  22,  40,  20,  40,  30,  40,  25,  45, 120,  60, 120,  60, 120,  60, 120,  60,  60,
32,  32, 128,  88, 160,  80, 160,  80, 160, 100, 180, 480, 240, 480, 240, 480, 240, 480, 240, 240,
16,  16,  64,  44,  80,  40,  80,  40,  80,  50,  90, 240, 120, 240, 120, 240, 120, 240, 120, 120,
32,  32, 128,  88, 160,  80, 160,  80, 160, 100, 180, 480, 240, 480, 240, 480, 240, 480, 240, 240,
16,  16,  64,  44,  80,  40,  80,  40,  80,  50,  90, 240, 120, 240, 120, 240, 120, 240, 120, 120,
32,  32, 128,  88, 160,  80, 160,  80, 160, 100, 180, 480, 240, 480, 240, 480, 240, 480, 240, 240,
16,  16,  64,  44,  80,  40,  80,  40,  80,  50,  90, 240, 120, 240, 120, 240, 120, 240, 120, 120,
32,  32, 128,  88, 160,  80, 160,  80, 160, 100, 180, 480, 240, 480, 240, 480, 240, 480, 240, 240,
24,  24,  96,  66, 120,  60, 120,  60, 120,  75, 135, 360, 180, 360, 180, 360, 180, 360, 180, 180,
64,  64, 256, 176, 320, 160, 320, 160, 320, 200, 360, 960, 480, 960, 480, 960, 480, 960, 480, 480,
32,  32, 128,  88, 160,  80, 160,  80, 160, 100, 120, 510, 222, 240, 180, 480, 240, 480, 240, 240,
64,  64, 256, 176, 320, 160, 320, 160, 320, 200, 120, 270,  33,   0, -30, 690, 480, 960, 480, 480, 
32,  32, 128,  88, 160,  80, 160,  80, 160, 100,  60,   0,   0,   0, -75, -30, 255, 510, 222, 120,
64,  64, 256, 176, 320, 160, 320, 160, 320, 155,  75,   0,   0,   0,   0,   0, 135, 372,  33,   0,
32,  32, 128,  88, 160,  80, 160, 105, 125,   5, -15,   0,   0,   0,   0,   0,   0,  33,   0,   0,
64,  64, 256, 176, 320, 160, 320, 170,  90,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
32,  32, 128,  88, 160,  80, 160,  40,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
64,  64, 256, 176, 320, 160, 275,  35,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
32,  32, 128,  88, 160, 105,  80, -25,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
64,  64, 256, 176, 320, 170,  90,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
32,  32, 128,  88, 160,  85,  45,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
64,  64, 256, 176, 320,  80,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
32,  32, 128,  88, 160,  40,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
64,  64, 256, 176, 320,  80,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
32,  32, 128,  88, 115,  -5,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
64,  64, 256, 176, 230, -10,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
32,  32, 128, 113,  80, -25,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
64,  64, 256, 186,  90,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
16,  16,  64,  69,  45,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0];

[m,n]=size(tab_cie);
if ( m == 30 | n == 21 )
    tab(1:29, 1:20) = tab_cie(2:30, 2:21);
else
    tab(:,:) = tab_cie(:,:);
end


coef_pond=tab.*tab_pondere;

for lig=1:29,
    coef(lig,:)=tg_gamma(lig)*coef_pond(lig,:);
end
Q0=sum(sum(coef))/10000/9936;
s1=tab(9,1)/tab(1,1);
s2=Q0/tab(1,1)*10000;
coef=[Q0 s1 s2];